 Vitest  "deps.external" is deprecated. If you rely on vite-node directly, use "server.deps.external" instead. Otherwise, consider using "deps.optimizer.ssr.exclude"

 RUN  v3.2.0 /Users/paulsondhi/listener/packages/server

ğŸš€ Starting global test setup...
ğŸ” Validating test environment...
âœ… Test environment validation passed
ğŸ—„ï¸  Initializing test database...
âœ… Test database initialized successfully
ğŸ”§ Setting up global test resources...
ğŸ­ Mock servers configured
ğŸ­ Test data generators initialized
ğŸ› ï¸  Global test utilities initialized
âœ… Global test resources setup completed
ğŸ“Š Setting up performance monitoring...
âœ… Performance monitoring initialized
âœ… Global test setup completed successfully
 âœ“ jobs/__tests__/sendNewsletterWorker.integration.test.ts > SendNewsletterWorker (integration) > should update sent_at for all eligible editions in normal mode 221ms
 Ã— jobs/__tests__/sendNewsletterWorker.integration.test.ts > SendNewsletterWorker (integration) > should NOT update sent_at in L10 mode 219ms
   â†’ expected +0 to be 2 // Object.is equality

â¯â¯â¯â¯â¯â¯â¯ Failed Tests 1 â¯â¯â¯â¯â¯â¯â¯

 FAIL  jobs/__tests__/sendNewsletterWorker.integration.test.ts > SendNewsletterWorker (integration) > should NOT update sent_at in L10 mode
AssertionError: expected +0 to be 2 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 2[39m
[31m+ 0[39m

 â¯ jobs/__tests__/sendNewsletterWorker.integration.test.ts:210:36
    208| 
    209|     // Original assertions
    210|     expect(result.successfulSends).toBe(2);
       |                                    ^
    211|     expect(result.errorCount).toBe(0);
    212| 

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/1]â¯


 Test Files  1 failed (1)
      Tests  1 failed | 1 passed (2)
   Start at  13:31:22
   Duration  611ms (transform 79ms, setup 20ms, collect 50ms, tests 441ms, environment 0ms, prepare 22ms)

